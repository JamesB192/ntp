#AUTOMAKE_OPTIONS = ../util/ansi2knr no-dependencies
#AUTOMAKE_OPTIONS = ../util/ansi2knr
noinst_LIBRARIES = @MAKE_LIBRSAREF@
EXTRA_LIBRARIES = librsaref.a
CLEANFILES = $(EXTRA_LIBRARIES)

# NOTES:
# don't use RSAREF's global.h - we use ours.

nodist_librsaref_a_HEADERS = \
	des.h \
	digit.h \
	md2.h \
	md5.h \
	nn.h \
	prime.h \
	r_random.h \
	rsa.h \
	rsaref.h

nodist_librsaref_a_SOURCES = \
	desc.c \
	digit.c \
	md2c.c \
	md5c.c \
	nn.c \
	prime.c \
	r_dh.c \
	r_encode.c \
	r_enhanc.c \
	r_keygen.c \
	r_random.c \
	r_stdlib.c \
	rsa.c

BUILT_SOURCES = $(nodist_librsaref_a_SOURCES) $(nodist_librsaref_a_HEADERS)
INCLUDES = -I$(top_srcdir)/include
ETAGS_ARGS = Makefile.am

#EXTRA_DIST = 

$(nodist_librsaref_a_SOURCES) $(nodist_librsaref_a_HEADERS): stamp-rsaref

stamp-rsaref:
	@rm -f stamp-rsaref stamp-rsarefT
	@echo timestamp > stamp-rsarefT 2> /dev/null
	for i in $(nodist_librsaref_a_SOURCES); do \
	    case "@MAKE_LIBRSAREF@" in \
	     '') touch $$i ;; \
	     *) cmp -s $$i $(srcdir)/../rsaref2/source/$$i 2>/dev/null \
		|| cp $(srcdir)/../rsaref2/source/$$i $$i ;; \
	    esac ; \
	done
	for i in $(nodist_librsaref_a_HEADERS); do \
	    case "@MAKE_LIBRSAREF@" in \
	     '') touch $$i ;; \
	     *) cmp -s $(srcdir)/$$i $(top_srcdir)/rsaref2/source/$$i 2>/dev/null \
		|| cp $(top_srcdir)/rsaref2/source/$$i $(srcdir)/$$i ;; \
	    esac ; \
	done
	@echo timestamp > stamp-rsarefT 2> /dev/null
	@mv stamp-rsarefT stamp-rsaref
